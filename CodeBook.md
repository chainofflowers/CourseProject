Code Book for "Getting and Cleaning Data" project assignment
=============
This is the code book related to the dataset produced for the Course Project assignment of "Getting and Cleaning Data" course.

The dataset is a text file named "*tidy_dataset.txt*" (not present in this GitHub repository), generated by the R script contained in the file "run_analysis.R". It is a tidy dataset in narrow format containing the average values of some measurements of the original raw dataset, as described in detail in the "Variable transformation" section of this document.

## Variables
The dataset is composed of the following variables, in order:
* **activity**: character string, an identifier of the activity. It can assume one of the following values:
  ```
LAYING
SITTING
STANDING
WALKING 
WALKING_DOWNSTAIRS
WALKING_UPSTAIRS
```

* **subject**: integer, an identifier of the subject (person) performing the activity. Can assume values from 1 to 30 (inclusive).
* **variable**: character string, the name of the measurement derived from the original dataset, in the form:
   ```
   <domain>-<measurement>-<function>-<axis>
```
  Can assume one of the following 66 values:
  ```
time-BodyAccel-mean-X            
time-BodyAccel-mean-Y            
time-BodyAccel-mean-Z            
time-BodyAccel-stdev-X           
time-BodyAccel-stdev-Y           
time-BodyAccel-stdev-Z           
time-GravityAccel-mean-X         
time-GravityAccel-mean-Y         
time-GravityAccel-mean-Z         
time-GravityAccel-stdev-X        
time-GravityAccel-stdev-Y        
time-GravityAccel-stdev-Z        
time-BodyAccelJerk-mean-X        
time-BodyAccelJerk-mean-Y        
time-BodyAccelJerk-mean-Z        
time-BodyAccelJerk-stdev-X       
time-BodyAccelJerk-stdev-Y       
time-BodyAccelJerk-stdev-Z       
time-BodyGyro-mean-X             
time-BodyGyro-mean-Y             
time-BodyGyro-mean-Z             
time-BodyGyro-stdev-X            
time-BodyGyro-stdev-Y            
time-BodyGyro-stdev-Z            
time-BodyGyroJerk-mean-X         
time-BodyGyroJerk-mean-Y         
time-BodyGyroJerk-mean-Z         
time-BodyGyroJerk-stdev-X        
time-BodyGyroJerk-stdev-Y        
time-BodyGyroJerk-stdev-Z        
time-BodyAccelMagnitude-mean     
time-BodyAccelMagnitude-stdev    
time-GravityAccelMagnitude-mean  
time-GravityAccelMagnitude-stdev 
time-BodyAccelJerkMagnitude-mean 
time-BodyAccelJerkMagnitude-stdev
time-BodyGyroMagnitude-mean      
time-BodyGyroMagnitude-stdev     
time-BodyGyroJerkMagnitude-mean  
time-BodyGyroJerkMagnitude-stdev 
freq-BodyAccel-mean-X            
freq-BodyAccel-mean-Y            
freq-BodyAccel-mean-Z            
freq-BodyAccel-stdev-X           
freq-BodyAccel-stdev-Y           
freq-BodyAccel-stdev-Z           
freq-BodyAccelJerk-mean-X        
freq-BodyAccelJerk-mean-Y        
freq-BodyAccelJerk-mean-Z        
freq-BodyAccelJerk-stdev-X       
freq-BodyAccelJerk-stdev-Y       
freq-BodyAccelJerk-stdev-Z       
freq-BodyGyro-mean-X             
freq-BodyGyro-mean-Y             
freq-BodyGyro-mean-Z             
freq-BodyGyro-stdev-X            
freq-BodyGyro-stdev-Y            
freq-BodyGyro-stdev-Z            
freq-BodyAccelMagnitude-mean     
freq-BodyAccelMagnitude-stdev    
freq-BodyAccelJerkMagnitude-mean 
freq-BodyAccelJerkMagnitude-stdev
freq-BodyGyroMagnitude-mean      
freq-BodyGyroMagnitude-stdev     
freq-BodyGyroJerkMagnitude-mean  
freq-BodyGyroJerkMagnitude-stdev 
```

* **average**: numeric, contains the average of the measurement in the "*variable*" field per each group of (activity,subject)

* **measure**: character string, identifying the measure in the original dataset from which the measure in the "variable" field were derived. It can assume of the following 10 values:
  ```
 BodyAccel           
 GravityAccel          
 BodyAccelJerk
 BodyGyro           
 BodyGyroJerk
 BodyAccelMagnitude  
 GravityAccelMagnitude
 BodyAccelJerkMagnitude
 BodyGyroMagnitude  
 BodyGyroJerkMagnitude

  ```

* **domain**: character string, identifying the domain of the variable. It can assume one of the following values:
  ```
  time
  frequency
  ```

* **axis**: character string, identifying the axis to which the measurement refers, if applicable, otherwise "NA". Can assume one of:
  ```
  X
  Y
  Z
  NA
  ```

* **function**: character string, identifying the function in the original dataset whose result where averaged to produce this dataset. It can assume one of the following values:
  ```
  mean  (for average)
  stdev (for standard deviation)
  ```


## Raw data source
The raw data source, as well as the description of the original project, is available here:
http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones

The direct link to the raw dataset is here:
https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip 

The raw data source consists of two separated datasets: one for the training of the system and for the actual test.

## Variables transformations from raw data
After the extraction of the raw dataset, the following steps were executed in R to obtain the final tidy dataset:

1. The file "*activity_labels.txt*" was read to create the lookup table for the activities (activity_id, activity_label)
2. The file "*features.txt*" was read to get the names of the measures (a.k.a. "variables")
3. For each sub-dataset "*train*" and "*test*":
  1. the file "*subject_<sub-dataset>.txt*" was read to get the identifiers of the subject performing the activities
  2. the file "*y_\<sub-dataset>\.txt*" was read to get the identifiers of the activity performed
  3. the file "*X_\<sub-dataset\>.txt*" was read to get the values of the measures for that subject/activity measurement (561 values per row)
4. While reading, the values where used to build a dataframe for each sub-dataset
5. The names of the measures (obtained at step 2) where used to name the columns of the dataframes
5. The two dataframes where merged together, by just "appending" one to the other, obtaining a dataframe for the "full dataset"
6. The full dataset was then filtered to get only the columns (variables) whose names contained one of the following values:
   ```
   std()
   mean()
   ```
   
7. The activity lookup table (obtained at step 1) was then joined with the full dataset to replace the activity identifiers with the activity labels
8. Subsequently, the column names where modified to make them more descriptive/intuitive, although trying to keep them short:
   1. the sub-string "BodyBody" was replaced with "Body" (this was an obvious typo in the raw dataset)
   2. the sub-strings "mean()" and "std()" where replaced with, respectively, "mean" and "stdev" (removing brackets)
   2. the sub-strings "Acc" and "Mag" where replaced with, respectively, "Accel" and "Magnitude"
   3. the first letter of the measurements ('t' and 'f') were expanded to make them meaning clearer ('time' and 'freq')
9. The resulting data table was then molten to have, on a single row:
   1. the "key" pair (activity, subject)
   2. the measure name (variable)
   3. the value of that variable
   
   With that, a tidy data table in narrow format was generated.
10. A new data table was then generated grouping the previous one by (activity, subject, variable) and computing the average of the values in each group. The results were put in the column "average".
11. Additional columns where then generated from the "variable" column (domain, measure, function, axis). Their values originated from the value of "variable", splitting it using a dash as a separator. For the measures not bound to an axis, the column "axis" was valued with the string "NA".
12. Eventually, the columns where reordered in the final form: (activity,subject,variable,average,measure,axis,domain,function).



All files were read from their respective folders where they were extracted, without moving them from their original position.

